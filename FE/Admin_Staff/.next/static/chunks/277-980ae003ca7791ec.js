"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{3917:(e,i,a)=>{a.d(i,{b:()=>t,f:()=>o});class t{static email(e){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)}static formatPrice(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}}function o(e){try{let i=e.split(".")[1];if(!i)throw Error("Invalid token");let a=i.replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(atob(a).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(t)}catch(e){return console.error("Error parsing JWT:",e),null}}},6277:(e,i,a)=>{a.d(i,{P:()=>f});var t=a(65453),o=a(35095),s=a(46786);let n={isLoading:!1,error:null};var l=a(88473),r=a(3917),d=a(87481);let c={user:void 0,userProfile:void 0,children:[],error:void 0,allUsers:[],myInfo:void 0},u={notifications:[],sendedNotifications:[]},g={roles:[],permissions:[]},v={vaccines:[],categories:[]},f=(0,t.v)()((0,s.lt)((0,s.Zr)((0,o.D)((e,i)=>({profile:c,...function(e){return{fetchAllUsers:async()=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let i=localStorage.getItem("token"),a=(await l.A.get("/manage/parents",{headers:{Authorization:"Bearer ".concat(i)}})).data||[];return e(e=>{e.profile.allUsers=a},!1,"fetchAllUsers: success"),a}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({variant:"destructive",description:e}),[]}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},fetchAllChildren:async()=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let i=(await l.A.get("/manage/children")).data||[];return e(e=>{e.profile.children=i},!1,"fetchAllChildren: success"),i}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({variant:"destructive",description:e}),[]}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},registerUser:async i=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.post("/users/createUser",i),(0,d.oR)({title:"Success",description:"Account created successfully! Please check your email for verification.",variant:"success"})}catch(i){var a,t;let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},verifyUser:async(i,a)=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.post("/users/verify",{email:i,code:a}),(0,d.oR)({title:"Success",description:"Email verified successfully!",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},resendVerification:async i=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.post("/users/resend",{email:i}),(0,d.oR)({title:"Success",description:"New verification code has been sent!",variant:"success"})}catch(i){var a,t;let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},login:async(i,a)=>{var t,o,s;e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let o=await l.A.post("/auth/login",{username:i,password:a}),s=null===(t=o.data)||void 0===t?void 0:t.result,n=null==s?void 0:s.token;if(n){localStorage.setItem("token",n);let a=(0,r.f)(n),t=(("object"==typeof a&&null!==a?a:{}).scope||"").replace(/ROLE_/g,"");localStorage.setItem("role",t),e(e=>{e.profile.user={id:s.id||0,name:s.name||i,username:i,fullname:s.fullname||i,email:s.email,token:n,role:t}},!1,"login: success"),(0,d.oR)({title:"Success",description:"Login successful!",variant:"success"})}}catch(i){let e=(null==i?void 0:null===(s=i.response)||void 0===s?void 0:null===(o=s.data)||void 0===o?void 0:o.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},fetchProfile:async()=>{var i,a,t;e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let a=await l.A.post("/users/profile"),t=(null===(i=a.data)||void 0===i?void 0:i.data)||void 0;e(e=>{e.profile.userProfile=t},!1,"fetchProfile: success")}catch(i){let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);(0,d.oR)({variant:"destructive",description:e})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},updateProfile:async i=>{var a,t,o;e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let t=await l.A.post("/users/profile/update",i),o=(null===(a=t.data)||void 0===a?void 0:a.data)||void 0;e(e=>{e.profile.userProfile=o},!1,"updateProfile: success"),(0,d.oR)({title:"Success",description:"Profile updated successfully",variant:"success"})}catch(i){let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},deleteUser:async i=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.delete("/users/delete/".concat(i))}catch(i){e(e=>{var a,t;e.profile.error=(null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||i.message},!1,"deleteUser: error")}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},logout:async()=>{e(e=>{e.loading.isLoading=!0},!1,"logout: start");try{localStorage.removeItem("token"),localStorage.removeItem("role"),e(e=>{e.profile.user=void 0},!1,"logout: success"),(0,d.oR)({title:"Success",description:"Logout successful!",variant:"success"})}catch(e){(0,d.oR)({title:"Error",description:(null==e?void 0:e.message)||"Logout failed",variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"logout: end")}},changePassword:async(i,a)=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.post("/users/changePassword",{oldPassword:i,newPassword:a,confirmPassword:a}),(0,d.oR)({title:"Success",description:"Password changed successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},createChild:async(i,a)=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.post("/staff/children/create/".concat(i),a),(0,d.oR)({title:"Success",description:"Child added successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},updateMyChild:async(i,a)=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{await l.A.put("/staff/children/".concat(i,"/update"),a),(0,d.oR)({title:"Success",description:"Child information updated successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}}}}(e),notification:u,...function(e){return{fetchNotifications:async()=>{try{e(e=>{e.loading.isLoading=!0});let i=localStorage.getItem("token"),a=await l.A.get("/notification/notifications",{headers:{Authorization:"Bearer ".concat(i)}}),t=a.data.result||a.data||[];e(e=>{e.notification.notifications=t})}catch(e){console.error("Failed to fetch notifications",e)}finally{e(e=>{e.loading.isLoading=!1})}},fetchSendedNotifications:async()=>{try{e(e=>{e.loading.isLoading=!0});let i=localStorage.getItem("token"),a=await l.A.get("/notification/notifications/sent",{headers:{Authorization:"Bearer ".concat(i)}}),t=a.data.result||a.data||[];e(e=>{e.notification.sendedNotifications=t})}catch(e){console.error("Failed to fetch notifications",e)}finally{e(e=>{e.loading.isLoading=!1})}},markAsRead:async i=>{try{let a=localStorage.getItem("token");await l.A.put("/notification/notifications/".concat(i,"/read"),i,{headers:{Authorization:"Bearer ".concat(a)}}),e(e=>{e.notification.notifications=e.notification.notifications.map(e=>e.id===i?{...e,readStatus:!0}:e)})}catch(e){console.error("Failed to mark notification as read",e)}},markAllAsRead:async()=>{try{let i=localStorage.getItem("token");await l.A.put("/notification/notifications/read-all",null,{headers:{Authorization:"Bearer ".concat(i)}}),e(e=>{e.notification.notifications=e.notification.notifications.map(e=>({...e,readStatus:!0}))})}catch(e){console.error("Failed to mark all notifications as read",e)}},setNotifications:i=>{e(e=>{e.notification.notifications=i})}}}(e),management:g,...function(e,i){return{fetchRoles:async()=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let i=(await l.A.get("/manage/roles")).data.result||[];return e(e=>{e.management.roles=i},!1,"fetchRoles: success"),i}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({title:"Error",description:e,variant:"destructive"}),[]}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},fetchPermissions:async()=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let i=(await l.A.get("/permissions/getAll")).data.result||[];return e(e=>{e.management.permissions=i},!1,"fetchPermissions: success"),i}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({title:"Error",description:e,variant:"destructive"}),[]}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},createPermission:async i=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let a=(await l.A.post("/permissions/create",i)).data.result;return e(e=>{e.management.permissions.push(a)},!1,"createPermission: success"),(0,d.oR)({title:"Success",description:"Permission created successfully",variant:"success"}),a}catch(i){var a,t;let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);throw(0,d.oR)({title:"Error",description:e,variant:"destructive"}),i}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},createRole:async a=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let t=(await l.A.post("/manage/createRole",a)).data.result;return i().fetchRoles(),e(e=>{e.management.roles.push(t)},!1,"createRole: success"),(0,d.oR)({title:"Success",description:"Role created successfully",variant:"success"}),t}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);throw(0,d.oR)({title:"Error",description:e,variant:"destructive"}),i}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}},deleteRole:async a=>{try{let t=await l.A.delete("/manage/".concat(a));return i().fetchRoles(),e(e=>{e.management.roles=e.management.roles.filter(e=>e.name!==a)},!1,"deleteRole: success"),(0,d.oR)({title:"Success",description:"Role deleted successfully",variant:"success"}),t.data}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);throw(0,d.oR)({title:"Error",description:e,variant:"destructive"}),i}},removePermission:async(e,i)=>{try{let a=await l.A.delete("/manage/roles/".concat(e,"/permissions/").concat(i));return(0,d.oR)({title:"Success",description:"Permission removed from role successfully",variant:"success"}),a.data}catch(i){var a,t;let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);throw(0,d.oR)({title:"Error",description:e,variant:"destructive"}),i}},deletePermission:async i=>{e(e=>{e.loading.isLoading=!0},!1,"loading: start");try{let a=await l.A.delete("/permissions/delete/".concat(i));return e(e=>{e.management.permissions=e.management.permissions.filter(e=>e.name!==i)},!1,"deletePermission: success"),(0,d.oR)({title:"Success",description:"Permission deleted successfully",variant:"success"}),a.data}catch(i){var a,t;let e=(null==i?void 0:null===(t=i.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.message)||(null==i?void 0:i.message);throw(0,d.oR)({title:"Error",description:e,variant:"destructive"}),i}finally{e(e=>{e.loading.isLoading=!1},!1,"loading: end")}}}}(e,i),product:v,...function(e,i){return{fetchVaccines:async()=>{e(e=>{e.loading.isLoading=!0});try{let i=localStorage.getItem("token"),a=(await l.A.get("/product/products",{headers:{Authorization:"Bearer ".concat(i)}})).data||[];return e(e=>{e.product.vaccines=a}),a}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({variant:"destructive",description:e}),[]}finally{e(e=>{e.loading.isLoading=!1})}},createVaccine:async a=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.post("/product/addProduct",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(e)}}),await i().fetchVaccines(),(0,d.oR)({title:"Success",description:"Vaccine created successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}},updateVaccine:async(a,t)=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.patch("/product/updateProduct/".concat(a),t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(e)}}),await i().fetchVaccines(),(0,d.oR)({title:"Success",description:"Vaccine updated successfully",variant:"success"})}catch(i){var o,s;let e=(null==i?void 0:null===(s=i.response)||void 0===s?void 0:null===(o=s.data)||void 0===o?void 0:o.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}},deleteVaccine:async a=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.delete("/product/deleteProduct/".concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),await i().fetchVaccines(),(0,d.oR)({title:"Success",description:"Vaccine deleted successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}},fetchCategories:async()=>{e(e=>{e.loading.isLoading=!0});try{let i=localStorage.getItem("token"),a=(await l.A.get("/category/showCategory",{headers:{Authorization:"Bearer ".concat(i)}})).data.result||[];return e(e=>{e.product.categories=a}),a}catch(t){var i,a;let e=(null==t?void 0:null===(a=t.response)||void 0===a?void 0:null===(i=a.data)||void 0===i?void 0:i.message)||(null==t?void 0:t.message);return(0,d.oR)({variant:"destructive",description:e}),[]}finally{e(e=>{e.loading.isLoading=!1})}},createCategory:async a=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.post("/category/createCategory",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(e)}}),await i().fetchCategories(),(0,d.oR)({title:"Success",description:"Category created successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}},updateCategory:async(a,t)=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.put("/category/updateCategory/".concat(a),t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(e)}}),await i().fetchCategories(),(0,d.oR)({title:"Success",description:"Category updated successfully",variant:"success"})}catch(i){var o,s;let e=(null==i?void 0:null===(s=i.response)||void 0===s?void 0:null===(o=s.data)||void 0===o?void 0:o.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}},deleteCategory:async a=>{e(e=>{e.loading.isLoading=!0});try{let e=localStorage.getItem("token");await l.A.delete("/category/deleteCategory/".concat(a),{headers:{Authorization:"Bearer ".concat(e)}}),await i().fetchCategories(),(0,d.oR)({title:"Success",description:"Category deleted successfully",variant:"success"})}catch(i){var t,o;let e=(null==i?void 0:null===(o=i.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||(null==i?void 0:i.message);(0,d.oR)({title:"Error",description:e,variant:"destructive"})}finally{e(e=>{e.loading.isLoading=!1})}}}}(e,i),loading:n})),{name:"zustand-store"})))}}]);